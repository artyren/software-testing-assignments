============================= test session starts ==============================
platform darwin -- Python 3.10.13, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/natashapaunovic/Documents/IT/softwareTesting/softwaretestingrepo/A1_unit_testing_students
plugins: anyio-3.6.2, regtest-1.5.1, mock-3.12.0
collected 48 items

regtest_natasha.py .............................................FFF      [100%]

=================================== FAILURES ===================================
__________________________ test_new_implementation_1 ___________________________

capsys = <_pytest.capture.CaptureFixture object at 0x1060fded0>

    def test_new_implementation_1(capsys):
        data = get_json("users.json")
        new_username = "NewUser" + str(len(data)+1)
        user_exists = False
        for user in data:
            if user["username"] == new_username:
                user_exists = True
        assert user_exists == False
        with patch('builtins.input', side_effect=[new_username, "", 'y', 'Hejsan123!', 'uppsala 123', '1122331122', new_username+'@mail.com', 'n']):
            with pytest.raises(StopIteration):
                searchAndBuyProduct()
        captured = capsys.readouterr()
        assert "You were successfully registered!" in captured.out
        data = get_json("users.json")
        assert data[-1]["username"] == new_username
>       assert data[-1]["address"] == 'uppsala 123'
E       KeyError: 'address'

regtest_natasha.py:560: KeyError
__________________________ test_new_implementation_2 ___________________________

    def test_new_implementation_2():
        data = get_json("users.json")
        new_username = "NewUser" + str(len(data)+1)
        with patch('builtins.input', side_effect=[new_username, "", 'y', 'Hejsan123!', 'uppsala 123', '1122331122', new_username+'@mail.com', 'y', '555-555-555-555', '12/12', new_username, '123' ]):
            with pytest.raises(StopIteration):
                searchAndBuyProduct()
        data = get_json("users.json")
>       assert len(data[-1]["credit_cards"]) != 0
E       KeyError: 'credit_cards'

regtest_natasha.py:575: KeyError
----------------------------- Captured stdout call -----------------------------
You were successfully registered!

Answer in wrong format, try again
__________________________ test_new_implementation_3 ___________________________

    def test_new_implementation_3():
        data = get_json("users.json")
        new_username = "NewUser" + str(len(data)+1)
        with patch('builtins.input', side_effect=[new_username, "", 'y', 'Hejsan123!', 'uppsala 123', '1122331122', new_username+'@mail.com', 'y', '555-555-555-555', '12/12', new_username, '123' ]):
            with pytest.raises(StopIteration):
                searchAndBuyProduct()
        data = get_json("users.json")
>       assert data[-1]["credit_cards"][0]['cvv'] == '123'
E       KeyError: 'credit_cards'

regtest_natasha.py:590: KeyError
----------------------------- Captured stdout call -----------------------------
You were successfully registered!

Answer in wrong format, try again
=========================== short test summary info ============================
FAILED regtest_natasha.py::test_new_implementation_1 - KeyError: 'address'
FAILED regtest_natasha.py::test_new_implementation_2 - KeyError: 'credit_cards'
FAILED regtest_natasha.py::test_new_implementation_3 - KeyError: 'credit_cards'
========================= 3 failed, 45 passed in 0.10s =========================
